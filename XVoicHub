local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TeleportService = game:GetService("TeleportService")
local lp = Players.LocalPlayer
local pg = lp:WaitForChild("PlayerGui")

local character = lp.Character or lp.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local hrp = character:WaitForChild("HumanoidRootPart")

local speedEnabled, jumpBoostEnabled, infJumpEnabled = false, false, false
local speedValue, jumpValue = 50, 100
local defaultWalkSpeed = 16

-- CHARAKTER BINDING
local function bindChar(char)
	character = char
	humanoid = char:WaitForChild("Humanoid")
	hrp = char:WaitForChild("HumanoidRootPart")
	defaultWalkSpeed = humanoid.WalkSpeed
end
lp.CharacterAdded:Connect(bindChar)

-- DEINE ORIGINALE SPEED-LOGIK + JUMP BOOST
RunService.Heartbeat:Connect(function()
	if not character or not humanoid or humanoid.Health <= 0 or not hrp then return end
	
	-- Jump Boost Logik (Konstant erzwingen)
	if jumpBoostEnabled then
		humanoid.JumpPower = jumpValue
		humanoid.UseJumpPower = true
	end

	-- Deine originale Speed-Logik (Vermischt mit den neuen Werten)
	if speedEnabled then
		humanoid.WalkSpeed = speedValue
		local dir = humanoid.MoveDirection
		if dir.Magnitude > 0.01 then
			dir = dir.Unit
			local v = hrp.AssemblyLinearVelocity
			local currentXZ = Vector3.new(v.X, 0, v.Z)
			local targetXZ = dir * speedValue
			local alpha = 0.12
			local newXZ = currentXZ + (targetXZ - currentXZ) * alpha
			local cap = speedValue + 6
			if newXZ.Magnitude > cap then newXZ = newXZ.Unit * cap end
			hrp.AssemblyLinearVelocity = Vector3.new(newXZ.X, v.Y, newXZ.Z)
		end
	end
end)

-- INFINITY JUMP
UserInputService.JumpRequest:Connect(function()
	if infJumpEnabled and hrp and humanoid then
		hrp.AssemblyLinearVelocity = Vector3.new(hrp.AssemblyLinearVelocity.X, 50, hrp.AssemblyLinearVelocity.Z)
	end
end)

-- GUI ROOT
local gui = Instance.new("ScreenGui")
gui.Name = "XVoicMultiHub_Custom"
gui.ResetOnSpawn = false
gui.Parent = pg

-- DESIGN HELPER
local function applyStyle(obj)
	local corner = Instance.new("UICorner", obj)
	corner.CornerRadius = UDim.new(0, 10)
	local stroke = Instance.new("UIStroke", obj)
	stroke.Thickness = 1.5
	stroke.Color = Color3.fromRGB(60, 60, 80)
	local grad = Instance.new("UIGradient", obj)
	grad.Color = ColorSequence.new(Color3.fromRGB(28,28,36), Color3.fromRGB(20,20,26))
	grad.Rotation = 90
end

local function createBtn(parent, text)
	local btn = Instance.new("TextButton", parent)
	btn.Size = UDim2.new(1, -24, 0, 36)
	btn.BackgroundColor3 = Color3.fromRGB(45, 50, 70)
	btn.TextColor3 = Color3.fromRGB(255, 255, 255)
	btn.Font = Enum.Font.GothamMedium
	btn.TextSize = 14
	btn.Text = text
	Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
	local s = Instance.new("UIStroke", btn) s.Color = Color3.fromRGB(70, 80, 110)
	return btn
end

local function createBox(parent, default)
	local box = Instance.new("TextBox", parent)
	box.Size = UDim2.new(1, -40, 0, 28)
	box.BackgroundColor3 = Color3.fromRGB(32, 34, 46)
	box.TextColor3 = Color3.fromRGB(255, 255, 255)
	box.Text = tostring(default)
	box.Font = Enum.Font.Gotham
	box.TextSize = 13
	Instance.new("UICorner", box).CornerRadius = UDim.new(0, 6)
	local s = Instance.new("UIStroke", box) s.Color = Color3.fromRGB(60, 70, 95)
	return box
end

-- DRAG FUNKTION
local function makeDraggable(topBar, frame)
	local dragging, dragStart, startPos
	topBar.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
			dragging = true dragStart = input.Position startPos = frame.Position
		end
	end)
	UserInputService.InputChanged:Connect(function(input)
		if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
			local delta = input.Position - dragStart
			frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
		end
	end)
	UserInputService.InputEnded:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then dragging = false end
	end)
end

-- PANEL 1: BOOSTER
local bFrame = Instance.new("Frame", gui)
bFrame.Size = UDim2.new(0, 220, 0, 220)
bFrame.Position = UDim2.new(0, 50, 0, 50)
bFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
bFrame.ClipsDescendants = true
applyStyle(bFrame)

local bTitle = Instance.new("TextButton", bFrame)
bTitle.Size = UDim2.new(1, 0, 0, 38)
bTitle.BackgroundTransparency = 1
bTitle.Text = "▲ - XVoic Booster -"
bTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
bTitle.Font = Enum.Font.GothamBold
bTitle.TextSize = 15

local bContent = Instance.new("Frame", bFrame)
bContent.Size = UDim2.new(1, 0, 1, -38)
bContent.Position = UDim2.new(0, 0, 0, 38)
bContent.BackgroundTransparency = 1
Instance.new("UIListLayout", bContent).HorizontalAlignment = Enum.HorizontalAlignment.Center
bContent.UIListLayout.Padding = UDim.new(0, 7)

local sBtn = createBtn(bContent, "Speed: OFF")
local sInp = createBox(bContent, speedValue)
local jBtn = createBtn(bContent, "Jump: OFF")
local jInp = createBox(bContent, jumpValue)

-- PANEL 2: MAIN
local mFrame = Instance.new("Frame", gui)
mFrame.Size = UDim2.new(0, 220, 0, 140)
mFrame.Position = UDim2.new(0, 50, 0, 280)
mFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
applyStyle(mFrame)

local mTitle = Instance.new("TextLabel", mFrame)
mTitle.Size = UDim2.new(1, 0, 0, 38)
mTitle.BackgroundTransparency = 1
mTitle.Text = "XVoic Hub"
mTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
mTitle.Font = Enum.Font.GothamBold

local mHide = Instance.new("TextButton", mFrame)
mHide.Size = UDim2.new(0, 24, 0, 24)
mHide.Position = UDim2.new(1, -30, 0, 7)
mHide.Text = "−"
mHide.BackgroundColor3 = Color3.fromRGB(60, 65, 90)
mHide.TextColor3 = Color3.fromRGB(255, 255, 255)
Instance.new("UICorner", mHide).CornerRadius = UDim.new(1, 0)

local mContent = Instance.new("Frame", mFrame)
mContent.Size = UDim2.new(1, 0, 1, -38)
mContent.Position = UDim2.new(0, 0, 0, 38)
mContent.BackgroundTransparency = 1
Instance.new("UIListLayout", mContent).HorizontalAlignment = Enum.HorizontalAlignment.Center
mContent.UIListLayout.Padding = UDim.new(0, 8)

local iBtn = createBtn(mContent, "Inf-Jump: OFF")
local rBtn = createBtn(mContent, "Rejoin Server")

local mini = Instance.new("TextButton", gui)
mini.Size = UDim2.new(0, 90, 0, 30)
mini.Position = UDim2.new(0, 10, 0, 10)
mini.Text = "Open Hub"
mini.Visible = false
mini.BackgroundColor3 = Color3.fromRGB(45, 50, 70)
mini.TextColor3 = Color3.fromRGB(255, 255, 255)
Instance.new("UICorner", mini)

-- LOGIK & EVENTS
makeDraggable(bTitle, bFrame)
makeDraggable(mTitle, mFrame)

bTitle.MouseButton1Click:Connect(function()
	bOpen = not bOpen
	bFrame:TweenSize(bOpen and UDim2.new(0, 220, 0, 220) or UDim2.new(0, 220, 0, 38), "Out", "Quad", 0.3, true)
	bTitle.Text = bOpen and "▲ - XVoic Booster -" or "▼ - XVoic Booster -"
	bContent.Visible = bOpen
end)

mHide.MouseButton1Click:Connect(function() mFrame.Visible = false mini.Visible = true end)
mini.MouseButton1Click:Connect(function() mFrame.Visible = true mini.Visible = false end)

sBtn.MouseButton1Click:Connect(function()
	speedEnabled = not speedEnabled
	sBtn.Text = speedEnabled and "Speed: ON" or "Speed: OFF"
	sBtn.BackgroundColor3 = speedEnabled and Color3.fromRGB(50, 160, 100) or Color3.fromRGB(45, 50, 70)
	if not speedEnabled then humanoid.WalkSpeed = defaultWalkSpeed end
end)

jBtn.MouseButton1Click:Connect(function()
	jumpBoostEnabled = not jumpBoostEnabled
	jBtn.Text = jumpBoostEnabled and "Jump: ON" or "Jump: OFF"
	jBtn.BackgroundColor3 = jumpBoostEnabled and Color3.fromRGB(50, 160, 100) or Color3.fromRGB(45, 50, 70)
	if not jumpBoostEnabled then humanoid.JumpPower = 50 end
end)

iBtn.MouseButton1Click:Connect(function()
	infJumpEnabled = not infJumpEnabled
	iBtn.Text = infJumpEnabled and "Inf-Jump: ON" or "Inf-Jump: OFF"
	iBtn.BackgroundColor3 = infJumpEnabled and Color3.fromRGB(50, 160, 100) or Color3.fromRGB(45, 50, 70)
end)

sInp.FocusLost:Connect(function() local v = tonumber(sInp.Text) if v then speedValue = v end end)
jInp.FocusLost:Connect(function() local v = tonumber(jInp.Text) if v then jumpValue = v end end)
rBtn.MouseButton1Click:Connect(function() TeleportService:TeleportToPlaceInstance(game.PlaceId, game.JobId, lp) end)

UserInputService.InputBegan:Connect(function(input, gp)
	if not gp and input.KeyCode == Enum.KeyCode.RightShift then gui.Enabled = not gui.Enabled end
end)
